# Nets Resnet Utils

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-nets.resnet_utils.subsample-start--->
## nets.resnet_utils.subsample

<!---Documatic-section-subsample-start--->
<!---Documatic-block-nets.resnet_utils.subsample-start--->
<details>
	<summary><code>nets.resnet_utils.subsample</code> code snippet</summary>

```python
def subsample(inputs, factor, scope=None):
    if factor == 1:
        return inputs
    else:
        return slim.max_pool2d(inputs, [1, 1], stride=factor, scope=scope)
```
</details>
<!---Documatic-block-nets.resnet_utils.subsample-end--->
<!---Documatic-section-subsample-end--->

# #
<!---Documatic-section-nets.resnet_utils.subsample-end--->

<!---Documatic-section-nets.resnet_utils.conv2d_same-start--->
## nets.resnet_utils.conv2d_same

<!---Documatic-section-conv2d_same-start--->
<!---Documatic-block-nets.resnet_utils.conv2d_same-start--->
<details>
	<summary><code>nets.resnet_utils.conv2d_same</code> code snippet</summary>

```python
def conv2d_same(inputs, num_outputs, kernel_size, stride, rate=1, scope=None):
    if stride == 1:
        return slim.conv2d(inputs, num_outputs, kernel_size, stride=1, rate=rate, padding='SAME', scope=scope)
    else:
        kernel_size_effective = kernel_size + (kernel_size - 1) * (rate - 1)
        pad_total = kernel_size_effective - 1
        pad_beg = pad_total // 2
        pad_end = pad_total - pad_beg
        inputs = tf.pad(inputs, [[0, 0], [pad_beg, pad_end], [pad_beg, pad_end], [0, 0]])
        return slim.conv2d(inputs, num_outputs, kernel_size, stride=stride, rate=rate, padding='VALID', scope=scope)
```
</details>
<!---Documatic-block-nets.resnet_utils.conv2d_same-end--->
<!---Documatic-section-conv2d_same-end--->

# #
<!---Documatic-section-nets.resnet_utils.conv2d_same-end--->

<!---Documatic-section-nets.resnet_utils.stack_blocks_dense-start--->
## nets.resnet_utils.stack_blocks_dense

<!---Documatic-section-stack_blocks_dense-start--->
<!---Documatic-block-nets.resnet_utils.stack_blocks_dense-start--->
<details>
	<summary><code>nets.resnet_utils.stack_blocks_dense</code> code snippet</summary>

```python
@slim.add_arg_scope
def stack_blocks_dense(net, blocks, output_stride=None, outputs_collections=None):
    current_stride = 1
    rate = 1
    for block in blocks:
        with tf.variable_scope(block.scope, 'block', [net]) as sc:
            for (i, unit) in enumerate(block.args):
                if output_stride is not None and current_stride > output_stride:
                    raise ValueError('The target output_stride cannot be reached.')
                with tf.variable_scope('unit_%d' % (i + 1), values=[net]):
                    (unit_depth, unit_depth_bottleneck, unit_stride) = unit
                    if output_stride is not None and current_stride == output_stride:
                        net = block.unit_fn(net, depth=unit_depth, depth_bottleneck=unit_depth_bottleneck, stride=1, rate=rate)
                        rate *= unit_stride
                    else:
                        net = block.unit_fn(net, depth=unit_depth, depth_bottleneck=unit_depth_bottleneck, stride=unit_stride, rate=1)
                        current_stride *= unit_stride
            print(sc.name, net.shape)
            net = slim.utils.collect_named_outputs(outputs_collections, sc.name, net)
    if output_stride is not None and current_stride != output_stride:
        raise ValueError('The target output_stride cannot be reached.')
    return net
```
</details>
<!---Documatic-block-nets.resnet_utils.stack_blocks_dense-end--->
<!---Documatic-section-stack_blocks_dense-end--->

# #
<!---Documatic-section-nets.resnet_utils.stack_blocks_dense-end--->

<!---Documatic-section-nets.resnet_utils.resnet_arg_scope-start--->
## nets.resnet_utils.resnet_arg_scope

<!---Documatic-section-resnet_arg_scope-start--->
<!---Documatic-block-nets.resnet_utils.resnet_arg_scope-start--->
<details>
	<summary><code>nets.resnet_utils.resnet_arg_scope</code> code snippet</summary>

```python
def resnet_arg_scope(weight_decay=0.0001, batch_norm_decay=0.997, batch_norm_epsilon=1e-05, batch_norm_scale=True):
    batch_norm_params = {'decay': batch_norm_decay, 'epsilon': batch_norm_epsilon, 'scale': batch_norm_scale, 'updates_collections': tf.GraphKeys.UPDATE_OPS}
    with slim.arg_scope([slim.conv2d], weights_regularizer=slim.l2_regularizer(weight_decay), weights_initializer=slim.variance_scaling_initializer(), activation_fn=tf.nn.relu, normalizer_fn=slim.batch_norm, normalizer_params=batch_norm_params):
        with slim.arg_scope([slim.batch_norm], **batch_norm_params):
            with slim.arg_scope([slim.max_pool2d], padding='SAME') as arg_sc:
                return arg_sc
```
</details>
<!---Documatic-block-nets.resnet_utils.resnet_arg_scope-end--->
<!---Documatic-section-resnet_arg_scope-end--->

# #
<!---Documatic-section-nets.resnet_utils.resnet_arg_scope-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)